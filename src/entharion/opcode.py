from dataclasses import dataclass
from typing import List, Tuple, Union


@dataclass
class Opcode:
    name: str
    versions: Union[str, List[int]]
    opcode_bytes: Tuple[int, int]
    store: bool = False

    def __init__(
        self,
        name: str,
        versions: Union[str, List[int]],
        opcode_bytes: Tuple[int, int],
        store: bool = False,
    ):
        if versions == "all":
            self.versions = [1, 2, 3, 4, 5, 6, 7, 8]
        else:
            self.versions = versions
        self.name = name
        self.opcode_bytes = opcode_bytes
        self.store = store

    def matches(self, version: int, opcode_byte: int, opcode_number: int) -> bool:
        return (
            version in self.versions
            and (opcode_byte, opcode_number) == self.opcode_bytes
        )


opcodes = [
    # 0OP
    Opcode(name="rtrue", versions="all", opcode_bytes=(176, 0)),
    Opcode(name="rfalse", versions="all", opcode_bytes=(177, 1)),
    Opcode(name="print", versions="all", opcode_bytes=(178, 2)),
    Opcode(name="print_ret", versions="all", opcode_bytes=(179, 3)),
    Opcode(name="nop", versions="all", opcode_bytes=(180, 4)),
    Opcode(name="save", versions=[1, 2, 3, 4], opcode_bytes=(181, 5)),
    Opcode(name="restore", versions=[1, 2, 3, 4], opcode_bytes=(182, 6)),
    Opcode(name="restart", versions="all", opcode_bytes=(183, 7)),
    Opcode(name="ret_popped", versions="all", opcode_bytes=(184, 8)),
    Opcode(name="pop", versions=[1, 2, 3, 4], opcode_bytes=(185, 9)),
    Opcode(name="catch", versions=[5, 6, 7, 8], opcode_bytes=(185, 9)),
    Opcode(name="quit", versions="all", opcode_bytes=(186, 10)),
    Opcode(name="new_line", versions="all", opcode_bytes=(187, 11)),
    Opcode(name="show_status", versions=[3], opcode_bytes=(188, 12)),
    Opcode(name="verify", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(189, 13)),
    # (190,14) is used for the first byte of extended opcode
    Opcode(name="piracy", versions=[5, 6, 7, 8], opcode_bytes=(191, 15)),
    # 1OP
    Opcode(name="jz", versions="all", opcode_bytes=(128, 0)),
    Opcode(name="jz", versions="all", opcode_bytes=(144, 0)),
    Opcode(name="jz", versions="all", opcode_bytes=(160, 0)),
    Opcode(name="get_sibling", versions="all", opcode_bytes=(129, 1)),
    Opcode(name="get_sibling", versions="all", opcode_bytes=(145, 1)),
    Opcode(name="get_sibling", versions="all", opcode_bytes=(161, 1)),
    Opcode(name="get_child", versions="all", opcode_bytes=(130, 2)),
    Opcode(name="get_child", versions="all", opcode_bytes=(146, 2)),
    Opcode(name="get_child", versions="all", opcode_bytes=(162, 2)),
    Opcode(name="get_parent", versions="all", opcode_bytes=(131, 3)),
    Opcode(name="get_parent", versions="all", opcode_bytes=(147, 3)),
    Opcode(name="get_parent", versions="all", opcode_bytes=(163, 3)),
    Opcode(name="get_prop_len", versions="all", opcode_bytes=(132, 4)),
    Opcode(name="get_prop_len", versions="all", opcode_bytes=(148, 4)),
    Opcode(name="get_prop_len", versions="all", opcode_bytes=(164, 4)),
    Opcode(name="inc", versions="all", opcode_bytes=(133, 5)),
    Opcode(name="inc", versions="all", opcode_bytes=(149, 5)),
    Opcode(name="inc", versions="all", opcode_bytes=(165, 5)),
    Opcode(name="dec", versions="all", opcode_bytes=(134, 6)),
    Opcode(name="dec", versions="all", opcode_bytes=(150, 6)),
    Opcode(name="dec", versions="all", opcode_bytes=(166, 6)),
    Opcode(name="print_addr", versions="all", opcode_bytes=(135, 7)),
    Opcode(name="print_addr", versions="all", opcode_bytes=(151, 7)),
    Opcode(name="print_addr", versions="all", opcode_bytes=(167, 7)),
    Opcode(name="call_1s", versions=[4, 5, 6, 7, 8], opcode_bytes=(136, 8)),
    Opcode(name="call_1s", versions="all", opcode_bytes=(152, 8)),
    Opcode(name="call_1s", versions="all", opcode_bytes=(168, 8)),
    Opcode(name="remove_obj", versions="all", opcode_bytes=(137, 9)),
    Opcode(name="remove_obj", versions="all", opcode_bytes=(153, 9)),
    Opcode(name="remove_obj", versions="all", opcode_bytes=(169, 9)),
    Opcode(name="print_obj", versions="all", opcode_bytes=(138, 10)),
    Opcode(name="print_obj", versions="all", opcode_bytes=(154, 10)),
    Opcode(name="print_obj", versions="all", opcode_bytes=(170, 10)),
    Opcode(name="ret", versions="all", opcode_bytes=(139, 11)),
    Opcode(name="ret", versions="all", opcode_bytes=(155, 11)),
    Opcode(name="ret", versions="all", opcode_bytes=(171, 11)),
    Opcode(name="jump", versions="all", opcode_bytes=(140, 12)),
    Opcode(name="jump", versions="all", opcode_bytes=(156, 12)),
    Opcode(name="jump", versions="all", opcode_bytes=(172, 12)),
    Opcode(name="print_paddr", versions="all", opcode_bytes=(141, 13)),
    Opcode(name="print_paddr", versions="all", opcode_bytes=(157, 13)),
    Opcode(name="print_paddr", versions="all", opcode_bytes=(173, 13)),
    Opcode(name="load", versions="all", opcode_bytes=(142, 14)),
    Opcode(name="load", versions="all", opcode_bytes=(158, 14)),
    Opcode(name="load", versions="all", opcode_bytes=(174, 14)),
    Opcode(name="not", versions=[1, 2, 3, 4], opcode_bytes=(143, 15)),
    Opcode(name="call_1n", versions=[5, 6, 7, 8], opcode_bytes=(159, 15)),
    Opcode(name="call_1n", versions="all", opcode_bytes=(175, 15)),
    # OP2
    Opcode(name="je", versions="all", opcode_bytes=(1, 1)),
    Opcode(name="je", versions="all", opcode_bytes=(33, 1)),
    Opcode(name="je", versions="all", opcode_bytes=(65, 1)),
    Opcode(name="je", versions="all", opcode_bytes=(97, 1)),
    Opcode(name="je", versions="all", opcode_bytes=(193, 1)),
    Opcode(name="jl", versions="all", opcode_bytes=(2, 2)),
    Opcode(name="jl", versions="all", opcode_bytes=(34, 2)),
    Opcode(name="jl", versions="all", opcode_bytes=(66, 2)),
    Opcode(name="jl", versions="all", opcode_bytes=(98, 2)),
    Opcode(name="jl", versions="all", opcode_bytes=(194, 2)),
    Opcode(name="jg", versions="all", opcode_bytes=(3, 3)),
    Opcode(name="jg", versions="all", opcode_bytes=(35, 3)),
    Opcode(name="jg", versions="all", opcode_bytes=(67, 3)),
    Opcode(name="jg", versions="all", opcode_bytes=(99, 3)),
    Opcode(name="jg", versions="all", opcode_bytes=(195, 3)),
    Opcode(name="dec_chk", versions="all", opcode_bytes=(4, 4)),
    Opcode(name="dec_chk", versions="all", opcode_bytes=(36, 4)),
    Opcode(name="dec_chk", versions="all", opcode_bytes=(68, 4)),
    Opcode(name="dec_chk", versions="all", opcode_bytes=(100, 4)),
    Opcode(name="dec_chk", versions="all", opcode_bytes=(196, 4)),
    Opcode(name="inc_chk", versions="all", opcode_bytes=(5, 5)),
    Opcode(name="inc_chk", versions="all", opcode_bytes=(37, 5)),
    Opcode(name="inc_chk", versions="all", opcode_bytes=(69, 5)),
    Opcode(name="inc_chk", versions="all", opcode_bytes=(101, 5)),
    Opcode(name="inc_chk", versions="all", opcode_bytes=(197, 5)),
    Opcode(name="jin", versions="all", opcode_bytes=(6, 6)),
    Opcode(name="jin", versions="all", opcode_bytes=(38, 6)),
    Opcode(name="jin", versions="all", opcode_bytes=(70, 6)),
    Opcode(name="jin", versions="all", opcode_bytes=(102, 6)),
    Opcode(name="jin", versions="all", opcode_bytes=(198, 6)),
    Opcode(name="test", versions="all", opcode_bytes=(7, 7)),
    Opcode(name="test", versions="all", opcode_bytes=(39, 7)),
    Opcode(name="test", versions="all", opcode_bytes=(71, 7)),
    Opcode(name="test", versions="all", opcode_bytes=(103, 7)),
    Opcode(name="test", versions="all", opcode_bytes=(199, 7)),
    Opcode(name="or", versions="all", opcode_bytes=(8, 8)),
    Opcode(name="or", versions="all", opcode_bytes=(40, 8)),
    Opcode(name="or", versions="all", opcode_bytes=(72, 8)),
    Opcode(name="or", versions="all", opcode_bytes=(104, 8)),
    Opcode(name="or", versions="all", opcode_bytes=(200, 8)),
    Opcode(name="and", versions="all", opcode_bytes=(9, 9)),
    Opcode(name="and", versions="all", opcode_bytes=(41, 9)),
    Opcode(name="and", versions="all", opcode_bytes=(73, 9)),
    Opcode(name="and", versions="all", opcode_bytes=(105, 9)),
    Opcode(name="and", versions="all", opcode_bytes=(201, 9)),
    Opcode(name="test_attr", versions="all", opcode_bytes=(10, 10)),
    Opcode(name="test_attr", versions="all", opcode_bytes=(42, 10)),
    Opcode(name="test_attr", versions="all", opcode_bytes=(74, 10)),
    Opcode(name="test_attr", versions="all", opcode_bytes=(106, 10)),
    Opcode(name="test_attr", versions="all", opcode_bytes=(202, 10)),
    Opcode(name="set_attr", versions="all", opcode_bytes=(11, 11)),
    Opcode(name="set_attr", versions="all", opcode_bytes=(43, 11)),
    Opcode(name="set_attr", versions="all", opcode_bytes=(75, 11)),
    Opcode(name="set_attr", versions="all", opcode_bytes=(107, 11)),
    Opcode(name="set_attr", versions="all", opcode_bytes=(203, 11)),
    Opcode(name="clear_attr", versions="all", opcode_bytes=(12, 12)),
    Opcode(name="clear_attr", versions="all", opcode_bytes=(44, 12)),
    Opcode(name="clear_attr", versions="all", opcode_bytes=(76, 12)),
    Opcode(name="clear_attr", versions="all", opcode_bytes=(108, 12)),
    Opcode(name="clear_attr", versions="all", opcode_bytes=(204, 12)),
    Opcode(name="store", versions="all", opcode_bytes=(13, 13)),
    Opcode(name="store", versions="all", opcode_bytes=(45, 13)),
    Opcode(name="store", versions="all", opcode_bytes=(77, 13)),
    Opcode(name="store", versions="all", opcode_bytes=(109, 13)),
    Opcode(name="store", versions="all", opcode_bytes=(205, 13)),
    Opcode(name="insert_obj", versions="all", opcode_bytes=(14, 14)),
    Opcode(name="insert_obj", versions="all", opcode_bytes=(46, 14)),
    Opcode(name="insert_obj", versions="all", opcode_bytes=(78, 14)),
    Opcode(name="insert_obj", versions="all", opcode_bytes=(110, 14)),
    Opcode(name="insert_obj", versions="all", opcode_bytes=(206, 14)),
    Opcode(name="loadw", versions="all", opcode_bytes=(15, 15)),
    Opcode(name="loadw", versions="all", opcode_bytes=(47, 15)),
    Opcode(name="loadw", versions="all", opcode_bytes=(79, 15)),
    Opcode(name="loadw", versions="all", opcode_bytes=(111, 15)),
    Opcode(name="loadw", versions="all", opcode_bytes=(207, 15)),
    Opcode(name="loadb", versions="all", opcode_bytes=(16, 16)),
    Opcode(name="loadb", versions="all", opcode_bytes=(48, 16)),
    Opcode(name="loadb", versions="all", opcode_bytes=(80, 16)),
    Opcode(name="loadb", versions="all", opcode_bytes=(112, 16)),
    Opcode(name="loadb", versions="all", opcode_bytes=(208, 16)),
    Opcode(name="get_prop", versions="all", opcode_bytes=(17, 17)),
    Opcode(name="get_prop", versions="all", opcode_bytes=(49, 17)),
    Opcode(name="get_prop", versions="all", opcode_bytes=(81, 17)),
    Opcode(name="get_prop", versions="all", opcode_bytes=(113, 17)),
    Opcode(name="get_prop", versions="all", opcode_bytes=(209, 17)),
    Opcode(name="get_prop_addr", versions="all", opcode_bytes=(18, 18)),
    Opcode(name="get_prop_addr", versions="all", opcode_bytes=(50, 18)),
    Opcode(name="get_prop_addr", versions="all", opcode_bytes=(82, 18)),
    Opcode(name="get_prop_addr", versions="all", opcode_bytes=(114, 18)),
    Opcode(name="get_prop_addr", versions="all", opcode_bytes=(210, 18)),
    Opcode(name="get_next_prop", versions="all", opcode_bytes=(19, 19)),
    Opcode(name="get_next_prop", versions="all", opcode_bytes=(51, 19)),
    Opcode(name="get_next_prop", versions="all", opcode_bytes=(83, 19)),
    Opcode(name="get_next_prop", versions="all", opcode_bytes=(115, 19)),
    Opcode(name="get_next_prop", versions="all", opcode_bytes=(211, 19)),
    Opcode(name="add", versions="all", opcode_bytes=(20, 20)),
    Opcode(name="add", versions="all", opcode_bytes=(52, 20)),
    Opcode(name="add", versions="all", opcode_bytes=(84, 20)),
    Opcode(name="add", versions="all", opcode_bytes=(116, 20)),
    Opcode(name="add", versions="all", opcode_bytes=(212, 20)),
    Opcode(name="sub", versions="all", opcode_bytes=(21, 21)),
    Opcode(name="sub", versions="all", opcode_bytes=(53, 21)),
    Opcode(name="sub", versions="all", opcode_bytes=(85, 21)),
    Opcode(name="sub", versions="all", opcode_bytes=(117, 21)),
    Opcode(name="sub", versions="all", opcode_bytes=(213, 21)),
    Opcode(name="mul", versions="all", opcode_bytes=(22, 22)),
    Opcode(name="mul", versions="all", opcode_bytes=(54, 22)),
    Opcode(name="mul", versions="all", opcode_bytes=(86, 22)),
    Opcode(name="mul", versions="all", opcode_bytes=(118, 22)),
    Opcode(name="mul", versions="all", opcode_bytes=(214, 22)),
    Opcode(name="div", versions="all", opcode_bytes=(23, 23)),
    Opcode(name="div", versions="all", opcode_bytes=(55, 23)),
    Opcode(name="div", versions="all", opcode_bytes=(87, 23)),
    Opcode(name="div", versions="all", opcode_bytes=(119, 23)),
    Opcode(name="div", versions="all", opcode_bytes=(215, 23)),
    Opcode(name="mod", versions="all", opcode_bytes=(24, 24)),
    Opcode(name="mod", versions="all", opcode_bytes=(56, 24)),
    Opcode(name="mod", versions="all", opcode_bytes=(88, 24)),
    Opcode(name="mod", versions="all", opcode_bytes=(120, 24)),
    Opcode(name="mod", versions="all", opcode_bytes=(216, 24)),
    Opcode(name="call_2s", versions=[4, 5, 6, 7, 8], opcode_bytes=(25, 25)),
    Opcode(name="call_2s", versions="all", opcode_bytes=(57, 25)),
    Opcode(name="call_2s", versions="all", opcode_bytes=(89, 25)),
    Opcode(name="call_2s", versions="all", opcode_bytes=(121, 25)),
    Opcode(name="call_2s", versions="all", opcode_bytes=(217, 25)),
    Opcode(name="call_2n", versions=[5, 6, 7, 8], opcode_bytes=(26, 26)),
    Opcode(name="call_2n", versions="all", opcode_bytes=(58, 26)),
    Opcode(name="call_2n", versions="all", opcode_bytes=(90, 26)),
    Opcode(name="call_2n", versions="all", opcode_bytes=(122, 26)),
    Opcode(name="call_2n", versions="all", opcode_bytes=(218, 26)),
    Opcode(name="set_colour", versions=[5, 6, 7, 8], opcode_bytes=(27, 27)),
    Opcode(name="set_colour", versions=[6, 7, 8], opcode_bytes=(59, 27)),
    Opcode(name="set_colour", versions="all", opcode_bytes=(91, 27)),
    Opcode(name="set_colour", versions="all", opcode_bytes=(123, 27)),
    Opcode(name="set_colour", versions="all", opcode_bytes=(219, 27)),
    Opcode(name="throw", versions=[5, 6, 7, 8], opcode_bytes=(28, 28)),
    Opcode(name="throw", versions="all", opcode_bytes=(60, 28)),
    Opcode(name="throw", versions="all", opcode_bytes=(92, 28)),
    Opcode(name="throw", versions="all", opcode_bytes=(124, 28)),
    Opcode(name="throw", versions="all", opcode_bytes=(220, 28)),
    # VAR
    Opcode(name="call", versions=[1, 2, 3], opcode_bytes=(224, 0), store=True),
    Opcode(name="call_vs", versions=[4, 5, 6, 7, 8], opcode_bytes=(224, 0)),
    Opcode(name="storew", versions="all", opcode_bytes=(225, 1)),
    Opcode(name="storeb", versions="all", opcode_bytes=(226, 2)),
    Opcode(name="put_prop", versions="all", opcode_bytes=(227, 3)),
    Opcode(name="sread", versions=[1, 2, 3, 4], opcode_bytes=(228, 4)),
    Opcode(name="aread", versions=[5, 6, 7, 8], opcode_bytes=(228, 4)),
    Opcode(name="print_char", versions="all", opcode_bytes=(229, 5)),
    Opcode(name="print_num", versions="all", opcode_bytes=(230, 6)),
    Opcode(name="random", versions="all", opcode_bytes=(231, 7)),
    Opcode(name="push", versions="all", opcode_bytes=(232, 8)),
    Opcode(name="pull", versions="all", opcode_bytes=(233, 9)),
    Opcode(name="split_window", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(234, 10)),
    Opcode(name="set_window", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(235, 11)),
    Opcode(name="call_vs2", versions=[4, 5, 6, 7, 8], opcode_bytes=(236, 12)),
    Opcode(name="erase_window", versions=[4, 5, 6, 7, 8], opcode_bytes=(237, 13)),
    Opcode(name="erase_line", versions=[4, 5, 6, 7, 8], opcode_bytes=(238, 14)),
    Opcode(name="set_cursor", versions=[4, 5, 6, 7, 8], opcode_bytes=(239, 15)),
    Opcode(name="get_cursor", versions=[4, 5, 6, 7, 8], opcode_bytes=(240, 16)),
    Opcode(name="set_text_style", versions=[4, 5, 6, 7, 8], opcode_bytes=(241, 17)),
    Opcode(name="buffer_mode", versions=[4, 5, 6, 7, 8], opcode_bytes=(242, 18)),
    Opcode(name="output_stream", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(243, 19)),
    Opcode(name="input_stream", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(244, 20)),
    Opcode(name="sound_effect", versions=[3, 4, 5, 6, 7, 8], opcode_bytes=(245, 21)),
    Opcode(name="read_char", versions=[4, 5, 6, 7, 8], opcode_bytes=(246, 22)),
    Opcode(name="scan_table", versions=[4, 5, 6, 7, 8], opcode_bytes=(247, 23)),
    Opcode(name="not", versions=[5, 6, 7, 8], opcode_bytes=(248, 24)),
    Opcode(name="call_vn", versions=[1, 2, 3], opcode_bytes=(249, 25)),
    Opcode(name="call_vn2", versions=[5, 6, 7, 8], opcode_bytes=(250, 26)),
    Opcode(name="tokenise", versions=[5, 6, 7, 8], opcode_bytes=(251, 27)),
    Opcode(name="encode_text", versions=[5, 6, 7, 8], opcode_bytes=(252, 28)),
    Opcode(name="copy_table", versions=[5, 6, 7, 8], opcode_bytes=(253, 29)),
    Opcode(name="print_table", versions=[5, 6, 7, 8], opcode_bytes=(254, 30)),
    Opcode(name="check_arg_count", versions=[5, 6, 7, 8], opcode_bytes=(255, 31)),
    # EXT
    Opcode(name="save", versions="all", opcode_bytes=(0, 0)),
    Opcode(name="restore", versions=[5, 6, 7, 8], opcode_bytes=(1, 1)),
    Opcode(name="log_shift", versions=[5, 6, 7, 8], opcode_bytes=(2, 2)),
    Opcode(name="art_shift", versions=[5, 6, 7, 8], opcode_bytes=(3, 3)),
    Opcode(name="set_font", versions=[5, 6, 7, 8], opcode_bytes=(4, 4)),
    Opcode(name="draw_picture", versions=[6, 7, 8], opcode_bytes=(5, 5)),
    Opcode(name="picture_data", versions=[6, 7, 8], opcode_bytes=(6, 6)),
    Opcode(name="erase_picture", versions=[6, 7, 8], opcode_bytes=(7, 7)),
    Opcode(name="set_margins", versions=[6, 7, 8], opcode_bytes=(8, 8)),
    Opcode(name="save_undo", versions=[5, 6, 7, 8], opcode_bytes=(9, 9)),
    Opcode(name="restore_undo", versions=[5, 6, 7, 8], opcode_bytes=(10, 10)),
    Opcode(name="print_unicode", versions=[5, 6, 7, 8], opcode_bytes=(11, 11)),
    Opcode(name="check_unicode", versions=[5, 6, 7, 8], opcode_bytes=(12, 12)),
    Opcode(name="set_true_colour", versions=[5, 6, 7, 8], opcode_bytes=(13, 13)),
    # (14, 14) and (15, 15) are unspecified
    Opcode(name="move_window", versions=[6, 7, 8], opcode_bytes=(16, 16)),
    Opcode(name="window_size", versions=[6, 7, 8], opcode_bytes=(17, 17)),
    Opcode(name="window_style", versions=[6, 7, 8], opcode_bytes=(18, 18)),
    Opcode(name="get_wind_prop", versions=[6, 7, 8], opcode_bytes=(19, 19)),
    Opcode(name="scroll_window", versions=[6, 7, 8], opcode_bytes=(20, 20)),
    Opcode(name="pop_stack", versions=[6, 7, 8], opcode_bytes=(21, 21)),
    Opcode(name="read_mouse", versions=[6, 7, 8], opcode_bytes=(22, 22)),
    Opcode(name="mouse_window", versions=[6, 7, 8], opcode_bytes=(23, 23)),
    Opcode(name="push_stack", versions=[6, 7, 8], opcode_bytes=(24, 24)),
    Opcode(name="put_wind_prop", versions=[6, 7, 8], opcode_bytes=(25, 25)),
    Opcode(name="print_form", versions=[6, 7, 8], opcode_bytes=(26, 26)),
    Opcode(name="make_menu", versions=[6, 7, 8], opcode_bytes=(27, 27)),
    Opcode(name="picture_table", versions=[6, 7, 8], opcode_bytes=(28, 28)),
    Opcode(name="buffer_screen", versions=[6, 7, 8], opcode_bytes=(29, 29)),
]
